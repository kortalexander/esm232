---
title: "Assignment 4"
author: "Kort Alexander and Grace Bianchi"
date: "2023-05-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
library(sensitivity)
library(lhs)
```

```{r}
# source conductance function
source(here("R", "Catm.R"))

# set parameters
pnames <- c("height", "k_d", "k_0", "v")
npar <- length(pnames)
nsample <- 100

# Use the Latin hypercube approach to generate parameter values for the 4 parameters
parm_quant <- randomLHS(nsample, npar)
colnames(parm_quant) <- pnames

parm = as.data.frame(matrix(nrow=nrow(parm_quant), ncol=ncol(parm_quant)))
colnames(parm) = pnames

percent_k_d_0 <- 0.01
parm[,"height"] = qunif(parm_quant[,"height"], min = 9.5, max = 10.5)
parm[,"k_d"] = qnorm(parm_quant[, "k_d"], mean = 0.7, sd = 0.7 * percent_k_d_0)
parm[,"k_0"] = qnorm(parm_quant[, "k_0"], mean = 0.1, sd = 0.1 * percent_k_d_0)
parm[, "v"] = qnorm(parm_quant[, "v"], mean = 250, sd = 30)
```

```{r}
# run our model for all of the parameters generated by LHS
amtos_conductance = parm %>% pmap(Catm, list(v = parm$v, height=parm$height, k_o=parm$k_0, k_d=parm$k_d))

# Plot conductance estimates against each of your parameters


# Estimate the Partial Rank Correlation Coefficients
```

